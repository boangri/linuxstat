#!/bin/sh
#
#
domain=$1
host=$2
RRDTOOL=/usr/bin/rrdtool
DIR=/var/lib/rrd/linuxstat/$domain/$host

if [ ! -d $DIR ]; then
  mkdir -p $DIR
  if [ ! -d $DIR ]; then
    echo "Could not create $DIR"
    exit 1
  fi
fi

STATFILE=$DIR/drbd.rrd
if [ -r $STATFILE ] ; then
  echo "File $STATFILE already exists!"
else
  $RRDTOOL create "$STATFILE" --start -1d \
                    DS:ns:COUNTER:600:0:U \
                    DS:nr:COUNTER:600:0:U \
                    DS:dw:COUNTER:600:0:U \
                    DS:dr:COUNTER:600:0:U \
                    DS:oos:GAUGE:600:0:U \
                    RRA:AVERAGE:0.9:1:600 \
                    RRA:AVERAGE:0.9:6:700 \
                    RRA:AVERAGE:0.9:24:775 \
                    RRA:AVERAGE:0.9:288:797 
  if [ $? -eq 0 ] ; then
    echo "File $STATFILE created"
  else 
    echo "File $STATFILE NOT created!"
  fi
fi
